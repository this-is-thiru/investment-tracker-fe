<header
  class="sticky top-0 z-50 w-full bg-[#191919]/95 backdrop-blur-sm border-b border-[#3A3A3A] flow-slide-up flow-delay-1"
>
  <div class="max-w-7xl mx-auto px-4 md:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <!-- Logo + Nav (Desktop) -->
      <div class="hidden md:flex items-center gap-6">
        <!-- Logo -->
        <button
          [routerLink]="['/home']"
          class="flex items-center gap-2 transition-transform hover:scale-[1.02]"
        >
          <div
            class="bg-gradient-to-br from-[#10A37F] to-[#1AA97D] p-2 rounded-lg transition-transform duration-300 hover:rotate-[5deg]"
          >
            <lucide-icon
              [name]="TrendingUp"
              class="h-5 w-5 text-white"
            ></lucide-icon>
          </div>
          <span class="text-xl font-semibold text-white">
            Investment Tracker
          </span>
        </button>

        <!-- Desktop Nav -->
        <nav class="flex items-center gap-1">
          <a
            *ngFor="let item of navItems"
            [routerLink]="['/', item.route]"
            routerLinkActive="bg-gradient-to-r from-[#10A37F]/20 to-[#1AA97D]/20 text-white"
            [routerLinkActiveOptions]="{ exact: true }"
            class="px-3 py-2 rounded-lg text-[13px] font-medium transition-all text-[#B3B3B3] hover:text-white hover:bg-[#232323] hover:-translate-y-0.5 active:scale-95"
          >
            {{ item.label }}
          </a>
        </nav>
      </div>

      <!-- Mobile Logo -->
      <button
        [routerLink]="['/home']"
        class="md:hidden flex items-center gap-2 transition-transform hover:scale-[1.02]"
      >
        <div
          class="bg-gradient-to-br from-[#10A37F] to-[#1AA97D] p-2 rounded-lg"
        >
          <lucide-icon
            [name]="TrendingUp"
            class="h-5 w-5 text-white"
          ></lucide-icon>
        </div>
        <span class="text-xl font-semibold text-white">Investment Tracker</span>
      </button>

      <!-- Mobile Controls -->
      <div class="md:hidden flex items-center gap-3">
        <!-- Notifications -->
        <div class="relative">
          <button
            (click)="toggleNotificationDropdown()"
            class="p-2 text-[#B3B3B3] hover:text-white hover:bg-[#232323] rounded-lg transition-all relative notification-toggle"
          >
            <lucide-icon [name]="Bell" class="h-5 w-5"></lucide-icon>
            <span
              class="absolute top-1.5 right-1.5 w-2 h-2 bg-[#10A37F] rounded-full"
            ></span>
          </button>

          <!-- Notification Dropdown -->
          <div
            *ngIf="isNotificationDropdownOpen"
            class="fixed top-16 right-2 left-2 w-80 max-w-[calc(100vw-2rem)] bg-[#232323] border border-[#3A3A3A] rounded-xl shadow-2xl overflow-hidden z-50 mobile-notification-dropdown"
          >
            <div
              class="p-4 border-b border-[#3A3A3A] flex items-center justify-between"
            >
              <h3 class="font-semibold text-white">Notifications</h3>
              <button class="text-xs text-[#10A37F] hover:text-[#0D8A6B]">
                Mark all as read
              </button>
            </div>

            <div class="max-h-96 overflow-y-auto">
              <button
                *ngFor="let notification of notifications"
                [attr.key]="notification.id"
                (click)="isNotificationDropdownOpen = false"
                class="w-full p-4 text-left hover:bg-[#2A2A2A] border-b border-[#3A3A3A]"
                [ngClass]="{ 'bg-[#10A37F]/5': notification.unread }"
              >
                <div class="flex items-start gap-3">
                  <div
                    class="w-2 h-2 rounded-full mt-2 shrink-0"
                    [ngClass]="{
                      'bg-[#10A37F]': notification.unread,
                      'bg-transparent': !notification.unread,
                    }"
                  ></div>
                  <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium text-white">
                      {{ notification.title }}
                    </p>
                    <p class="text-xs text-[#B3B3B3]">
                      {{ notification.desc }}
                    </p>
                    <p class="text-xs text-[#666666]">
                      {{ notification.time }}
                    </p>
                  </div>
                </div>
              </button>
            </div>

            <div class="p-3 border-t border-[#3A3A3A] text-center">
              <button class="text-sm text-[#10A37F] hover:text-[#0D8A6B]">
                View all notifications
              </button>
            </div>
          </div>
        </div>

        <!-- Profile / Mobile Menu -->
        <div class="relative">
          <button
            (click)="toggleMobileMenu()"
            class="p-2 text-[#B3B3B3] hover:text-white hover:bg-[#232323] rounded-lg transition-all mobile-menu-toggle"
          >
            <lucide-icon [name]="User" class="h-5 w-5"></lucide-icon>
          </button>

          <!-- Mobile Menu -->
          <div
            *ngIf="isMobileMenuOpen"
            class="absolute top-12 right-0 w-64 bg-[#232323] border border-[#3A3A3A] rounded-xl shadow-2xl overflow-hidden z-50 mobile-menu-dropdown"
          >
            <div class="p-2">
              <p
                class="px-3 py-2 text-xs text-[#666666] uppercase tracking-wider"
              >
                Features
              </p>

              <a
                *ngFor="let item of navItems"
                [routerLink]="['/', item.route]"
                routerLinkActive="bg-gradient-to-r from-[#10A37F]/20 to-[#1AA97D]/20 text-white"
                [routerLinkActiveOptions]="{ exact: true }"
                (click)="isMobileMenuOpen = false"
                class="block w-full px-3 py-2.5 rounded-lg text-sm font-medium transition-all text-[#B3B3B3] hover:text-white hover:bg-[#2A2A2A]"
              >
                {{ item.label }}
              </a>
            </div>

            <div class="h-px bg-[#3A3A3A] mx-2"></div>

            <div class="p-3 space-y-2">
              <ng-container *ngIf="!isAuthenticated(); else signedIn">
                <button
                  (click)="onNavigate('sign-in')"
                  class="w-full px-4 py-2.5 text-sm border border-[#3A3A3A] text-white rounded-lg hover:bg-[#2A2A2A]"
                >
                  Sign in
                </button>
                <button
                  [routerLink]="[{ outlets: { modal: ['sign-up'] } }]"
                  class="w-full px-4 py-2.5 text-sm bg-[#10A37F]/10 text-[#10A37F] border border-[#10A37F]/20 rounded-lg hover:bg-[#10A37F]/20 hover:border-[#10A37F]/30 transition-all"
                >
                  Sign up
                </button>
              </ng-container>

              <ng-template #signedIn>
                <button
                  (click)="signOut()"
                  class="w-full px-4 py-2.5 text-sm bg-red-500/10 text-red-400 border border-red-500/20 rounded-lg hover:bg-red-500/20 hover:border-red-500/30 transition-all flex items-center justify-center gap-2"
                >
                  Sign out
                </button>
              </ng-template>
            </div>
          </div>
        </div>
      </div>

      <!-- Desktop Right Controls -->
      <div class="hidden md:flex items-center gap-3">
        <!-- Notifications -->
        <div class="relative">
          <button
            (click)="toggleNotificationDropdown()"
            class="p-2 text-[#B3B3B3] hover:text-white hover:bg-[#232323] rounded-lg transition-all relative notification-toggle"
          >
            <lucide-icon [name]="Bell" class="h-5 w-5"></lucide-icon>
            <span
              class="absolute top-1.5 right-1.5 w-2 h-2 bg-[#10A37F] rounded-full"
            ></span>
          </button>

          <!-- Notification Dropdown -->
          <div
            *ngIf="isNotificationDropdownOpen"
            class="absolute top-12 right-0 w-80 bg-[#232323] border border-[#3A3A3A] rounded-xl shadow-2xl overflow-hidden z-50 desktop-notification-dropdown"
          >
            <div
              class="p-4 border-b border-[#3A3A3A] flex items-center justify-between"
            >
              <h3 class="font-semibold text-white">Notifications</h3>
              <button class="text-xs text-[#10A37F] hover:text-[#0D8A6B]">
                Mark all as read
              </button>
            </div>

            <div class="max-h-96 overflow-y-auto">
              <button
                *ngFor="let notification of notifications"
                [attr.key]="notification.id"
                class="w-full p-4 text-left hover:bg-[#2A2A2A] border-b border-[#3A3A3A]"
                [ngClass]="{ 'bg-[#10A37F]/5': notification.unread }"
              >
                <div class="flex items-start gap-3">
                  <div
                    class="w-2 h-2 rounded-full mt-2 shrink-0"
                    [ngClass]="{
                      'bg-[#10A37F]': notification.unread,
                      'bg-transparent': !notification.unread,
                    }"
                  ></div>
                  <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium text-white">
                      {{ notification.title }}
                    </p>
                    <p class="text-xs text-[#B3B3B3]">
                      {{ notification.desc }}
                    </p>
                    <p class="text-xs text-[#666666]">
                      {{ notification.time }}
                    </p>
                  </div>
                </div>
              </button>
            </div>

            <div class="p-3 border-t border-[#3A3A3A] text-center">
              <button class="text-sm text-[#10A37F] hover:text-[#0D8A6B]">
                View all notifications
              </button>
            </div>
          </div>
        </div>

        <!-- Profile Dropdown -->
        <div class="relative">
          <button
            (click)="toggleProfileDropdown()"
            class="flex items-center gap-2 p-2 pr-3 text-[#B3B3B3] hover:text-white hover:bg-[#232323] rounded-lg transition-all profile-toggle"
          >
            <lucide-icon [name]="User" class="h-5 w-5"></lucide-icon>
            <lucide-icon
              [name]="ChevronDown"
              class="h-4 w-4 transition-transform duration-300"
              [ngClass]="{ 'rotate-180': isProfileDropdownOpen }"
            ></lucide-icon>
          </button>

          <!-- Dropdown -->
          <div
            *ngIf="isProfileDropdownOpen"
            class="absolute top-12 right-0 w-56 bg-[#232323] border border-[#3A3A3A] rounded-xl shadow-2xl overflow-hidden z-50 profile-dropdown"
          >
            <div class="p-3 space-y-2">
              <ng-container *ngIf="!isAuthenticated(); else signedInDesktop">
                <button
                  (click)="onNavigate('sign-in')"
                  class="w-full px-4 py-2.5 text-sm border border-[#3A3A3A] text-white rounded-lg hover:bg-[#2A2A2A]"
                >
                  Sign in
                </button>
                <button
                  [routerLink]="[{ outlets: { modal: ['sign-up'] } }]"
                  class="w-full px-4 py-2.5 text-sm bg-[#10A37F]/10 text-[#10A37F] border border-[#10A37F]/20 rounded-lg hover:bg-[#10A37F]/20 hover:border-[#10A37F]/30 transition-all"
                >
                  Sign up
                </button>
              </ng-container>

              <ng-template #signedInDesktop>
                <button
                  (click)="signOut()"
                  class="w-full px-4 py-2.5 text-sm bg-red-500/10 text-red-400 border border-red-500/20 rounded-lg hover:bg-red-500/20 hover:border-red-500/30 transition-all flex items-center justify-center gap-2"
                >
                  Sign out
                </button>
              </ng-template>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<!-- Main content -->
<router-outlet></router-outlet>
<router-outlet name="modal"></router-outlet>

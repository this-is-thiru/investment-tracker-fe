<app-expansion-panel
  [title]="'Upload Transactions'"
  [subtitle]="'Start by uploading your transaction files'"
  [titleIcon]="'Upload'"
  [iconBgClass]="
    'bg-gradient-to-br from-[#10A37F] to-[#0D8968] p-2 rounded-lg text-white'
  "
  class="animate-fade-in-up stagger-2"
>
<div class="space-y-6">
  <div
    *ngIf="!hasUploadedFile && !isUploading && !selectedFile"
    (dragover)="handleDragOver($event)"
    (drop)="handleDrop($event)"
    (click)="fileInput.click()"
    class="border-2 border-dashed border-[#3A3A3A] rounded-xl p-12 text-center hover:border-[#10A37F]/50 hover:bg-[#10A37F]/5 transition-all cursor-pointer group"
  >
    <div
      class="bg-[#10A37F]/10 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform"
    >
      <lucide-icon name="upload" class="h-8 w-8 text-[#10A37F]"></lucide-icon>
    </div>
    <p class="text-white mb-2 font-medium">
      Drag and drop your transaction file here
    </p>
    <p class="text-[#B3B3B3] text-sm mb-4">or click to browse files</p>
    <button
      class="px-6 py-2.5 bg-gradient-to-r from-[#10A37F]/60 to-[#0D8968]/60 text-white rounded-lg font-medium hover:shadow-lg transition-all hover-scale"
    >
      Select Files
    </button>
    <p class="text-xs text-[#666666] mt-4">
      Supported formats: XLSX, XLS (Max 10MB)
    </p>
    <input
      #fileInput
      type="file"
      accept=".xlsx,.xls"
      class="hidden"
      (change)="handleFileSelect($event)"
    />
  </div>

  <div
    *ngIf="selectedFile && !isUploading && !hasUploadedFile"
    class="bg-gradient-to-br from-[#353535] to-[#2E2E2E] border border-[#505050] rounded-xl p-4 animate-fade-in-up shadow-lg"
  >
    <div class="flex items-start justify-between mb-4">
      <div class="flex items-start gap-3">
        <div
          class="bg-gradient-to-br from-[#10A37F]/20 to-[#0D8968]/20 p-2.5 rounded-lg border border-[#10A37F]/30"
        >
          <lucide-icon
            name="upload"
            class="h-5 w-5 text-[#10A37F]"
          ></lucide-icon>
        </div>
        <div>
          <h4 class="text-white font-semibold mb-1">File Selected</h4>
          <p class="text-[#CCCCCC] text-sm">{{ uploadedFileName }}</p>
          <p class="text-[#888888] text-xs mt-1">
            {{ formatFileSize(selectedFile.size) }}
          </p>
        </div>
      </div>
      <button
        (click)="handleCancelFile()"
        class="text-[#888888] hover:text-[#EF4444] transition-colors"
      >
        <lucide-icon name="x" class="h-5 w-5"></lucide-icon>
      </button>
    </div>
    <div class="flex gap-3">
      <button
        (click)="handleSendFile()"
        class="flex-1 bg-gradient-to-r from-[#10A37F] to-[#0D8968] text-white px-4 py-2.5 rounded-lg hover:shadow-xl hover:shadow-[#10A37F]/20 transition-all flex items-center justify-center gap-2 hover-scale"
      >
        <lucide-icon name="upload" class="h-4 w-4"></lucide-icon>
        Send File
      </button>
    </div>
  </div>

  <div
    *ngIf="isUploading"
    class="space-y-3 animate-fade-in bg-[#232323] border border-[#3A3A3A] rounded-xl p-6"
  >
    <div class="flex items-center justify-between">
      <p class="text-sm text-[#CCCCCC]">Uploading {{ uploadedFileName }}...</p>
      <p class="text-sm text-[#10A37F] font-semibold">{{ uploadProgress }}%</p>
    </div>
    <div
      class="bg-[#2E2E2E] relative h-2.5 w-full overflow-hidden rounded-full border border-[#404040]"
    >
      <div
        class="bg-gradient-to-r from-[#10A37F] to-[#0D8968] h-full transition-all duration-200 shadow-lg shadow-[#10A37F]/50"
        [style.width.%]="uploadProgress"
      ></div>
    </div>
  </div>

  <div
    *ngIf="hasUploadedFile && !isUploading"
    class="bg-gradient-to-br from-[#10A37F]/15 to-[#0D8968]/10 border border-[#10A37F]/40 rounded-xl p-4 animate-scale-in shadow-lg"
  >
    <div class="flex items-start justify-between">
      <div class="flex items-start gap-3">
        <lucide-icon
          name="check-circle-2"
          class="h-6 w-6 text-[#10A37F] mt-0.5"
        ></lucide-icon>
        <div>
          <h4 class="text-[#10A37F] font-semibold mb-1">
            File Uploaded Successfully!
          </h4>
          <p class="text-[#CCCCCC] text-sm">{{ uploadedFileName }}</p>
        </div>
      </div>
      <button
        (click)="removeFile()"
        class="text-[#888888] hover:text-[#EF4444] transition-colors"
      >
        <lucide-icon name="x" class="h-5 w-5"></lucide-icon>
      </button>
    </div>
  </div>

  <div class="pt-2">
    <button
      (click)="handleDownloadTemplate()"
      class="flex items-center gap-2 text-[#10A37F] hover:text-[#0D8968] hover:-translate-y-0.5 active:scale-95 transition-all"
    >
      <lucide-icon name="download" class="h-4 w-4"></lucide-icon>
      <span class="text-sm">Download Template</span>
    </button>
  </div>

  <div
    *ngIf="hasUploadedFile"
    class="bg-gradient-to-br from-[#10A37F]/15 to-[#0D8968]/10 border border-[#10A37F]/40 rounded-xl p-4 animate-fade-in-up shadow-lg"
  >
    <div class="flex items-start gap-3">
      <lucide-icon
        name="check-circle-2"
        class="h-5 w-5 text-[#10A37F] mt-0.5"
      ></lucide-icon>
      <div>
        <h4 class="text-[#10A37F] font-semibold mb-1">Ready for Processing</h4>
        <p class="text-[#CCCCCC] text-sm">
          Your file has been uploaded successfully. You can now process
          corporate actions below.
        </p>
      </div>
    </div>
  </div>
</div>
</app-expansion-panel>

<div class="fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6 animate-fade-in">
  <!-- Backdrop -->
  <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" (click)="onClose()"></div>

  <!-- Modal -->
  <div class="relative bg-[#1E1E1E] border border-[#3A3A3A] rounded-xl w-full max-w-xs shadow-xl animate-scale-in">
    
    <!-- Close Button -->
    <button type="button" (click)="onClose()" aria-label="Close"
      class="absolute top-3 right-3 text-[#999999] hover:text-white transition-colors p-1">
      <lucide-icon name="x" class="h-4 w-4"></lucide-icon>
    </button>

    <div class="p-5">
      <!-- Header -->
      <header class="text-center mb-5">
        <h1 class="text-lg text-white mb-0.5 font-semibold">Change Password</h1>
        <p class="text-xs text-[#999999]">
          Enter your old password and choose a new password to update.
        </p>
      </header>

      <!-- Form -->
      <form [formGroup]="changePasswordForm" (ngSubmit)="onSubmit()" class="space-y-4">

        <!-- Old Password -->
        <div>
          <label class="block text-xs text-[#B3B3B3] mb-1.5">Old Password</label>
          <input type="password" formControlName="oldPassword" placeholder="Old password"
            class="w-full bg-[#2A2A2A] border border-[#3A3A3A] rounded-lg px-3 py-2 text-sm text-white placeholder-[#666666] focus:outline-none focus:border-[#10A37F] focus:ring-2 focus:ring-[#10A37F]/40 transition-all" required />
        </div>

        <!-- New Password -->
        <div>
          <label class="block text-xs text-[#B3B3B3] mb-1.5">New Password</label>
          <input type="password" formControlName="newPassword" placeholder="New password"
            class="w-full bg-[#2A2A2A] border border-[#3A3A3A] rounded-lg px-3 py-2 text-sm text-white placeholder-[#666666] focus:outline-none focus:border-[#10A37F] focus:ring-2 focus:ring-[#10A37F]/40 transition-all" required />
        </div>

        <!-- Confirm New Password -->
        <div>
          <label class="block text-xs text-[#B3B3B3] mb-1.5">Confirm New Password</label>
          <input type="password" formControlName="confirmPassword" placeholder="Confirm new password"
            class="w-full bg-[#2A2A2A] border border-[#3A3A3A] rounded-lg px-3 py-2 text-sm text-white placeholder-[#666666] focus:outline-none focus:border-[#10A37F] focus:ring-2 focus:ring-[#10A37F]/40 transition-all" required />
          <p *ngIf="passwordMismatch" class="text-xs text-red-500 mt-1">Passwords do not match.</p>
        </div>

        <!-- Submit Button -->
        <button type="submit" [disabled]="changePasswordForm.invalid || isLoading"
          class="w-full rounded-lg bg-[#10A37F] px-4 py-2.5 text-sm font-semibold text-white transition-all hover:bg-[#0D8A6B] active:scale-[0.99] disabled:cursor-not-allowed disabled:bg-[#334A42]">
          <ng-container *ngIf="!isLoading">Change Password</ng-container>
          <ng-container *ngIf="isLoading">Saving...</ng-container>
        </button>

        <!-- Success / Error Message -->
        <p *ngIf="message" [class.text-red-500]="isError" [class.text-green-500]="!isError"
          class="text-xs text-center mt-2">{{ message }}</p>
      </form>
    </div>
  </div>
</div>
